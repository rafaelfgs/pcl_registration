<launch>

    # REALSENSE ITV   0.07 0 0.16 0 0.02 0 0.9998
    # REALSENSE UFMG  0.27 0 0.07 0 0 0 1

    <arg name = "prefix"      default = "d435i"/>
    <arg name = "compressed"  default = "true"/>
    <arg name = "tf_odom"     default = "0.27 0 0.07 0 0 0 1"/>


    <node if = "$(arg compressed)"
          pkg  = "image_transport"
          type = "republish"
          name = "decompress_node"
          output = "screen"
          args = "compressedDepth in:=/d435i/aligned_depth_to_color/image_raw
                             raw out:=/d435i/aligned_depth_to_color/image_raw">
    </node>


    <node if = "$(eval arg('prefix')=='t265')"
          pkg = "pcl_registration"
          type = "stereo_to_depth.py"
          name = "stereo_to_depth_node"
          output = "screen"
          args = "">

        <param name = "show_window" value = "false"/>
        <param name = "prefix"      value = "$(arg prefix)"/>
        <param name = "publish_tf"  value = "true"/>
        <param name = "image_size"  value = "320"/>
        <param name = "freq"        value = "1.0"/>

    </node>


    <node if = "true"
          pkg = "pcl_registration"
          type = "depth_to_cloud.py"
          name = "depth_to_cloud_node"
          output = "screen"
          args = "" >

        <param name = "prefix"      value = "$(arg prefix)"/>
        <param name = "image_size"  value = "320"/>
        <param name = "min_range"   value = "2.0"/>
        <param name = "max_range"   value = "6.0"/>
        <param name = "freq"        value = "1.0"/>

    </node>


    <node if = "true"
          pkg = "pcl_registration"
          type = "cloud_aggregator.py"
          name = "cloud_aggregator_node"
          output = "screen"
          args = "" >

        <param name = "prefix"      value = "$(arg prefix)"/>
        <param name = "publish_tf"  value = "true"/>
        <param name = "tf"          value = "$(arg tf_odom)"/>
        <param name = "freq"        value = "0.2"/>
        <param name = "freq_min"    value = "0.1"/>

    </node>


    <node if = "false"
          pkg = "pcl_registration"
          type = "cloud_to_file_online.py"
          name = "cloud_to_file_node"
          output = "screen"
          args = "" >

        <param name = "prefix"      value = "$(arg prefix)"/>
        <param name = "file_name"   value = "/mnt/WD500/UFMG/DISSERTACAO/bags/veloso_registration.pcd"/>

    </node>


</launch>
